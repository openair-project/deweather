<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-GB"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create a 2-way partial dependence plot for deweather models ‚Äî plot_dw_partial_2d ‚Ä¢ deweather</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Nunito_Sans-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create a 2-way partial dependence plot for deweather models ‚Äî plot_dw_partial_2d"><meta name="description" content="Generates 2-way partial dependence plot to visualize the relationship between
two predictor variables and model predictions. These plots show how the
predicted pollutant concentration changes as a function of two variables
while averaging over the effects of all other variables."><meta property="og:description" content="Generates 2-way partial dependence plot to visualize the relationship between
two predictor variables and model predictions. These plots show how the
predicted pollutant concentration changes as a function of two variables
while averaging over the effects of all other variables."><meta property="og:image" content="https://openair-project.github.io/deweather/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">deweather</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/deweather.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-case-studies-external-" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Case Studies (External)</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-case-studies-external-"><li><a class="external-link dropdown-item" href="https://www.sciencedirect.com/science/article/pii/S004896971834244X">(2019) Using meteorological normalisation to detect interventions in air quality time series</a></li>
    <li><a class="external-link dropdown-item" href="https://www.sciencedirect.com/science/article/abs/pii/S1352231012001355">(2012) A short-term intervention study ‚Äî Impact of airport closure due to the eruption of Eyjafjallaj√∂kull on near-field air quality</a></li>
    <li><a class="external-link dropdown-item" href="https://www.sciencedirect.com/science/article/abs/pii/S1352231009003069">(2009) Analysis of air pollution data at a mixed source location using boosted regression trees</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openair-project" aria-label="Website"><span class="fa fa-globe"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://openair-project.github.io/book/" aria-label="Book"><span class="fa fa-book"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/openair-project/deweather/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-packages" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Packages</button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-packages"><li><h6 class="dropdown-header" data-toc-skip>Data Analysis</h6></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/openair/">üß≠ openair</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/openairmaps/">üó∫Ô∏è openairmaps</a></li>
    <li><a class="dropdown-item" href="https://openair-project.github.io/deweather/">üìâ deweather</a></li>
    <li><h6 class="dropdown-header" data-toc-skip>Data Access</h6></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/worldmet/">üçÉ worldmet</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/euroaq/">üåç euroaq</a></li>
    <li><a class="external-link dropdown-item" href="https://openair-project.github.io/ukaq/">üëë ukaq</a></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Create a 2-way partial dependence plot for deweather models</h1>
      <small class="dont-index">Source: <a href="https://github.com/openair-project/deweather/blob/main/R/plot_dw_partial_2d.R" class="external-link"><code>R/plot_dw_partial_2d.R</code></a></small>
      <div class="d-none name"><code>plot_dw_partial_2d.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates 2-way partial dependence plot to visualize the relationship between
two predictor variables and model predictions. These plots show how the
predicted pollutant concentration changes as a function of two variables
while averaging over the effects of all other variables.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_dw_partial_2d</span><span class="op">(</span></span>
<span>  <span class="va">dw</span>,</span>
<span>  var_x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  var_y <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  intervals <span class="op">=</span> <span class="fl">40L</span>,</span>
<span>  contour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"lines"</span>, <span class="st">"fill"</span><span class="op">)</span>,</span>
<span>  contour_bins <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  exclude_distance <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  show_conf_int <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prop <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"viridis"</span>,</span>
<span>  radial_wd <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  progress <span class="op">=</span> <span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="https://rlang.r-lib.org/reference/is_interactive.html" class="external-link">is_interactive</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dw">dw<a class="anchor" aria-label="anchor" href="#arg-dw"></a></dt>
<dd><p>A deweather model created with <code><a href="build_dw_model.html">build_dw_model()</a></code>.</p></dd>


<dt id="arg-var-x-var-y">var_x, var_y<a class="anchor" aria-label="anchor" href="#arg-var-x-var-y"></a></dt>
<dd><p>The name of the two variables to plot. Must be one of the
variables used in the model. If both are missing, the top two most
individually important numeric variables will be selected automatically.</p></dd>


<dt id="arg-intervals">intervals<a class="anchor" aria-label="anchor" href="#arg-intervals"></a></dt>
<dd><p>The number of points for the partial dependence profile.</p></dd>


<dt id="arg-contour">contour<a class="anchor" aria-label="anchor" href="#arg-contour"></a></dt>
<dd><p>Show contour lines on the plot? Can be one of <code>"none"</code> (the
default, no contour lines), <code>"lines"</code> (draws lines) or <code>"fill"</code> (draws
filled contours using a binned colour scale).</p></dd>


<dt id="arg-contour-bins">contour_bins<a class="anchor" aria-label="anchor" href="#arg-contour-bins"></a></dt>
<dd><p>How many bins should be drawn if <code>contour != "none"</code>?</p></dd>


<dt id="arg-exclude-distance">exclude_distance<a class="anchor" aria-label="anchor" href="#arg-exclude-distance"></a></dt>
<dd><p>A 2-way partial dependence plot uses
<code><a href="https://rdrr.io/pkg/mgcv/man/exclude.too.far.html" class="external-link">mgcv::exclude.too.far()</a></code> to ensure the plotted surface is within range of
the original input data. <code>exclude_distance</code> defines how far away from the
original data is too far to plot. This should be in the range <code>0</code> to <code>1</code>,
where higher values are more permissive; <code>1</code> will retain all data.</p></dd>


<dt id="arg-show-conf-int">show_conf_int<a class="anchor" aria-label="anchor" href="#arg-show-conf-int"></a></dt>
<dd><p>Should the bootstrapped 95% confidence interval be
shown? In <code>plot_dw_partial_2d()</code> this creates separate facets for the lower
and higher confidence intervals. It may be easiest to see the difference by
using <code>contour = "fill"</code>.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>The number of observations to use for calculating the partial
dependence profile. If <code>NULL</code> (default), uses <code>prop</code> to determine the
sample size.</p></dd>


<dt id="arg-prop">prop<a class="anchor" aria-label="anchor" href="#arg-prop"></a></dt>
<dd><p>The proportion of input data to use for calculating the partial
dependence profile, between 0 and 1. Default is <code>0.01</code> (1% of input data).
Ignored if <code>n</code> is specified.</p></dd>


<dt id="arg-cols">cols<a class="anchor" aria-label="anchor" href="#arg-cols"></a></dt>
<dd><p>Colours to use for plotting. See <code><a href="https://openair-project.github.io/openair/reference/openColours.html" class="external-link">openair::openColours()</a></code>.</p></dd>


<dt id="arg-radial-wd">radial_wd<a class="anchor" aria-label="anchor" href="#arg-radial-wd"></a></dt>
<dd><p>Should the <code>"wd"</code> (wind direction) variable be plotted on a
radial axis? This can enhance interpretability, but makes it inconsistent
with other variables which are plotted on cartesian coordinates. Defaults
to <code>FALSE</code>.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>When <code>FALSE</code>, return a list of plot data instead of a plot.</p></dd>


<dt id="arg-progress">progress<a class="anchor" aria-label="anchor" href="#arg-progress"></a></dt>
<dd><p>Show a progress bar? Defaults to <code>TRUE</code> in interactive
sessions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot2</code> object showing the partial dependence plot. If <code>plot = FALSE</code>, a named list of plot data will be returned instead.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by David Carslaw, Jack Davison.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

