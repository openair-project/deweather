---
title: "Hyperparameter Cheat Sheet"
---

```{r opts, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, include = FALSE}
library(parsnip)
library(xgboost)
library(ranger)
library(lightgbm)
library(bonsai)
```

Under the hood, `deweather` uses the `parsnip` package. This package harmonises many different modelling engines, meaning `deweather` can make it very easy to switch between engines with a consistent API.

However, for users familiar with the engine packages themselves (i.e., `xgboost`, `ligthgbm`, and `ranger`), it can make it challenging to understand which hyperparameter you're actually tweaking when setting `trees` or `mtry` or any of the other arguments in `build_dw_model()`.

The table in this article can be considered a 'cheat sheet' so you can understand how different `deweather` arguments map onto their engine equivalents.

```{r prep, include = FALSE}
envir <- parsnip::get_model_env()

args <- ls(envir) |>
  tibble::enframe(name = NULL) |>
  dplyr::filter(grepl("args", value)) |>
  dplyr::mutate(
    model = sub("_args", "", value),
    args = purrr::map(value, ~ envir[[.x]])
  ) |>
  tidyr::unnest(args) |>
  dplyr::select(model:original)
```

```{r table, echo = FALSE}
args |>
  dplyr::filter(engine %in% c("xgboost", "lightgbm", "ranger")) |>
  # some lightgbm params don't apply
  dplyr::filter(ifelse(
    engine == "lightgbm" & parsnip %in% c("stop_iter", "sample_size"),
    FALSE,
    TRUE
  )) |>
  dplyr::select(-model) |>
  tidyr::pivot_wider(
    names_from = engine,
    values_from = original,
    values_fill = "-"
  ) |>
  dplyr::rename(`deweather/parsnip` = parsnip) |>
  knitr::kable()
```
